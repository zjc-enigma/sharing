#+Title: Remote workstation
#+Author: jiancheng.zhai
#+Email: jiancheng.pro@gmail.com
#+OPTIONS: toc:nil reveal_mathjax:t
#+OPTIONS: ^:nil
#+OPTIONS: toc:nil num:nil
#+STARTUP: indent
#+REVEAL_THEME: white
#+REVEAL_TRANS: linear    
#+REVEAL_ROOT: http://cdn.jsdelivr.net/reveal.js/3.0.0/

* Story 大纲
** howto 搭建机器学习工作站
** about tensorflow
** 其他功能扩展

* Why

| 工作方式 vs 特性         | 本地 | 公司服务器 | 个人工作站 |
|--------------------------+------+------------+------------|
| 开发/测试/部署环境一致   | ✘    | ✘          | ✔          |
| 支持高负荷复杂任务       | ✘    | ✔          | ✔          |
| 关机/休眠/断网不中断工作 | ✘    | ✔          | ✔          |
| 工作时不依赖特定设备     | ✘    | ✔          | ✔          |
| 终端设备成本低           | ✘    | ✔          | ✔          |
| 全部资源可用             | ✘    | ✘          | ✔          |
| 系统最高权限可控         | ✔    | ✘          | ✔          |
| 硬件可控                 | ✘    | ✘          | ✔          |
| 支持个性化定制           | ✔    | ✘          | ✔          |
| 不依赖 VPN               | ✘    | ✘          | ✔          |
| 支持虚拟化               | ✘    | ✘          | ✔          |
| 支持私有云服务           | ✘    | ✘          | ✔          |
| 环境配置长期稳定有效     | ✘    | ✘          | ✔          |
| 图形界面支持             | ✔    | ✘          | ✔          |

* 方案
** 需求
*** 支持 GPU CUDA 加速
*** 多任务处理性能
*** 稳定
*** 支持虚拟化
*** 随时访问
*** 大硬盘容量

** 云主机
*** AWS
**** 网速延迟
**** 性能弱
**** 非竞价实例很贵 / 竞价实例不稳定
*** Aliyun
**** 比 AWS 便宜，但仍然很贵
**** 网速有优势(仅限 GPU 实例)
**** 不一定申请得到
*** Google ECS
**** 300$ 试用，据说速度快

** 物理机
*** 商用机
贵，稳定，完全不操心

*** 准系统
比 DIY 贵少许，极大减轻组装和选配件的麻烦，强烈推荐

*** 完全 DIY
最便宜，折腾，乐趣？

* 配置
** 大致预算
*** 5k ~ 8k
**** 上代 E5 / i7 + 单路顶级 GPU
*** 8k ~ 1W+
**** E3 / i7 + 单路顶级 GPU
*** 1W ~ 2W
**** i7 + 单路 顶级 GPU + 硬盘阵列
*** 3W+
**** 双路 E5 + 4 路顶级 GPU + 硬盘阵列

** 平台
*** Z270
**** i7
*** X99
**** i7
**** 超频
*** C620
**** E5
**** 双路

*** AMD 平台
锐龙

*** 其他
**** 矿机机架
**** 二手服务器

** 主板
*** 稳定性
**** 大厂主板 + 优质电源 + 良好的散热

*** 扩展性
**** PCI 插槽
PCI 4x \ 8x \ 16x
**** m.2 接口
**** 内存槽
双通道 、 三通道、四通道
**** SATA，SAS
**** raid
**** 5 针雷电口
**** 注意插槽布局，预防遮挡或长度不够

*** 推荐
**** 超微 x10 系列 / 准系统 7048
**** 华硕 X99

** CPU
*** 产品一览
**** E5，E3
服务器 U，支持大容量校验内存，多路，PCI 总线多，核心多缓存大，不能超频
**** i7
家用 U，核心少，缓存小，主频高，支持的内存小，可以超频（需要主板支持和加强散热）
**** amd
家用 U，接近顶级 i7，性价比很高，支持的内存小，可以超频（需要主板支持和加强散热）

*** 重要指标
**** 主频
***** 对单线程应用影响显著
**** 缓存
***** 越大越好
**** 总线
40 条 PCIE
**** 制程
**** 架构
**** 超线程技术（HT）
*** 选购
**** 盒装、散装
**** ES、QS
**** 上代 E5

*** 推荐
**** i7 6950x
**** amd Zen / 7700k / E3 1230v5
**** i7 4950 / 上代 E5

** 显卡
*** 产品一览
**** 1070 
**** 1080
**** 1080 ti 
指标非常接近 titan x，性价比很高
**** titan x Pascal
新 titan，家用顶级
**** K40
专业计算卡，廉价双精度，深度学习没必要

*** 重要指标
**** 显存
***** 取决于模型大小
**** cuda 单元
**** 频率

*** 推荐型号
**** 1080ti / Titan X
**** 1070 / 1080
**** 980ti
*** FPGA 卡

** 散热器
*** 产品一览
**** 水冷
**** 风冷
**** 显卡水冷
*** 注意事项
**** 风道
**** 机箱的安装位是否匹配
*** 推荐
**** 玄冰风冷
**** 海盗船 H60i / H100i

** 机箱
*** 产品一览
**** itx
**** 中塔
**** 全塔
**** 1U、2U

*** 重要指标
**** 结实程度
**** 风扇位
**** 和主板螺丝孔匹配
**** 最大支持的显卡长度
**** 硬盘位

** 内存
*** 产品一览
**** DDR3 / DDR4 
**** RECC / ECC 

*** 重要指标
**** 是否支持校验
ECC / RECC
**** 频率
2133、2400、更高
**** 电压
低压、标压
**** 通道数
3 通道、4 通道

** 硬盘
*** 产品一览
**** ssd
*****  m.2 ssd
*****  sata ssd
*****  pci ssd
*****  pci 转 m.2
**** HDD

*** 重要指标
**** 读写速度
**** 转速
**** 缓存大小

*** 推荐
**** 希捷 8T
**** 西数红盘
**** 三星 pro960 m.2
**** intel 750 pci


** 电源
*** 产品一览
**** 全新优质电源
**** 二手服务器电源


*** 重要指标
**** 功率
>=显卡总功率*2

*** 推荐
海盗船 1000W / 1500W

** 网络
*** 网卡
*** 路由
**** openwrt
**** ddwrt
*** 交换机
*** 线材

** 扩展
*** ups 后备电源
*** nas / raid
**** 硬 raid
**** 软 raid
**** fake raid
**** raid 0
**** raid 1
**** raid 5
**** raid 6
**** raid 10
**** raidz
内存 + cache, 详见 zfs
*** 推荐
**** 群晖
**** hp gen8
**** 乔鼎

* DIY 注意事项

** 基本
*** 远离静电
*** 插孔匹配原则
** CPU
*** 方向 
*** 引脚对齐
*** 硅脂

** 主板
*** 阅读说明书
*** 去掉多余铜柱
** 内存
*** 颜色/多通道
*** 保持型号规格一致

** 散热器
*** 接好才再上电

** 硬盘
*** 固定紧
*** 平放

** PCI 设备
*** 用螺钉紧固

* OS
** 安装方式
*** livecd
*** usb
*** 硬盘
** ubuntu
** gentoo
*** 通过 use 标签定制包功能
*** Clags 优化，稳定性
*** 内核剪裁
*** 源码
*** slot 多版本共存
*** 文档

** 内核
*** docker
*** BBR
*** CPU
**** 架构
**** 核心数
**** 调度策略
*** 内存
**** 4 通道
**** 频率
**** 校验
*** 文件系统
**** ZFS 支持


** systemd
** openrc

** ulimit
** 分区

* 应用
** for ML
*** nvidia-driver
*** cuda-toolkit
*** cudnn
*** tensorflow 安装
**** pip
tensorflow-gpu
**** docker / nvidia-docker
**** anaconda
**** 系统包管理器
**** github 编译
bazel / proxy chains
**** nvidia 官网教程
**** 手动安装
*** tensorflow 扩展
**** tensorflow board
**** tensorflow serving
**** tensorflow cluster
公司服务器 pip 安装 tensorflow for cpu
*** jupyter
*** superset

** for work
*** screen / tmux
*** spacevim / spacemacs
*** nextcloud
*** neo4j
*** airflow
*** 分布式
**** 爬虫
**** 消息队列

*** 邮件服务
**** mutt / sendmail
**** stmp 

** for fun
*** mldonkey
*** hashview
*** bitcoin
*** 蜜罐
*** ZFS
**** ZIL 
**** L2ARG 
**** 内存缓冲
**** 去重 
**** zraid
*** lvm
*** opencl

* Tensorflow
** 基本概念
*** tensor
*** variable
*** graph
*** placeholder
*** session

** 常用工具
*** tflearn
*** tensorflow board
*** debug

** 优化问题求解
*** optimize
*** gradient
*** equal constraint
*** inequal constraint
*** normalize constraint

** 示例
*** lr
*** ocsvm

* 远程
** 光猫桥接 + DMZ
*** 实测联通 200M 光猫可破
*** 端口转发安全性更高，只是比较繁琐

** ssh 隧道 + 跳板机
*** 阿里云北京 5M
** ngrok
*** go 语言
*** 简单快捷
** DDNS
*** netgear
*** dnspod
*** push_ip / get_ip
** ssh 图形界面
*** ssh -YC
*** export DISPLAY
** vnc

* Tips
** 网络安全
*** 换 ssh 默认端口
*** 及时打补丁升级服务
*** 禁用 root 登录 ssh
*** 使用密钥而非密码登录
*** 域名隐私保护
*** iptables 防火墙

*** 入侵检测

** 解除限制
*** 80 端口
**** 跳板机 nginx 代理 
**** 使用 https，443 端口

*** DNS 污染
**** 自建递归 DNS
*** VPN
*** SS
**** vultr
**** linode
**** 阿里云香港节点
**** google ECS
*
*** nginx 反向代理

** 域名
*** 购买
**** godaddy
**** 万网
*** DNS 设置
**** A 记录
**** CNAME 记录
**** NS server

** UPS 电源
*** 断电预警，短信通知

** 雷电接口
*** linux 雷电驱动尚不可用

** 延续
*** 虚拟化
**** hyperv
**** esxi
windows / linux / osx
**** xen
**** docker
docker hub，交叉编译，github，自动构建
*** 备份
**** tar 命令
**** 外接备份硬盘矩阵
**** raid 之外安装备份盘
* Q & A
