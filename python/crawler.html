<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Python web crawler</title>
<meta name="author" content="(jiancheng.zhai)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/reveal.css"/>

<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/theme/night.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'http://cdn.jsdelivr.net/reveal.js/3.0.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title">Python web crawler</h1><h2 class="author">jiancheng.zhai</h2><p class="date">Created: 2016-10-11 Tue 17:48</p>
</section>

<section>
<section id="slide-orgheadline1">
<h2 id="orgheadline1">工作原理</h2>

</section>
</section>
<section>
<section id="slide-orgheadline5">
<h2 id="orgheadline5">Http 请求</h2>
<div class="outline-text-2" id="text-orgheadline5">
</div></section>
<section id="slide-orgheadline2">
<h3 id="orgheadline2">urllib</h3>
<div class="org-src-container">

<pre  class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">values</span> = <span style="color: #4f97d7;">{}</span>
&gt;&gt;&gt; <span style="color: #7590db;">values</span><span style="color: #4f97d7;">[</span><span style="color: #2d9574;">'username'</span><span style="color: #4f97d7;">]</span> = <span style="color: #2d9574;">"1016903103@qq.com"</span>
&gt;&gt;&gt; <span style="color: #7590db;">values</span><span style="color: #4f97d7;">[</span><span style="color: #2d9574;">'password'</span><span style="color: #4f97d7;">]</span> = <span style="color: #2d9574;">"</span><span style="color: #cc9393;">XXXX</span><span style="color: #2d9574;">"</span>
&gt;&gt;&gt; <span style="color: #7590db;">headers</span> = <span style="color: #4f97d7;">{</span><span style="color: #2d9574;">'User-Agent'</span>:<span style="color: #2d9574;">'Mozilla/6.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6'</span> <span style="color: #4f97d7;">}</span>
&gt;&gt;&gt; <span style="color: #7590db;">data</span> = urllib.urlencode<span style="color: #4f97d7;">(</span>values<span style="color: #4f97d7;">)</span> 
&gt;&gt;&gt; <span style="color: #7590db;">request</span> = urllib2.Request<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://www.baidu.com"</span>, data, headers=headers<span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">response</span> = urllib2.urlopen<span style="color: #4f97d7;">(</span>request<span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span> response.read<span style="color: #4f97d7;">()</span>
</pre>
</div>

</section>
<section id="slide-orgheadline3">
<h3 id="orgheadline3">requests: HTTP for Humans 发送请求</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35774;&#32622;&#32534;&#30721;</span>
&gt;&gt;&gt; r.encoding
<span style="color: #2d9574;">'utf-8'</span>
&gt;&gt;&gt; <span style="color: #7590db;">r.encoding</span> = <span style="color: #2d9574;">'ISO-8859-1'</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#23450;&#21046; headers</span>
&gt;&gt;&gt; <span style="color: #7590db;">url</span> = <span style="color: #2d9574;">'https://api.github.com/some/endpoint'</span>
&gt;&gt;&gt; <span style="color: #7590db;">headers</span> = <span style="color: #4f97d7;">{</span><span style="color: #2d9574;">'user-agent'</span>: <span style="color: #2d9574;">'my-app/0.0.1'</span><span style="color: #4f97d7;">}</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.get<span style="color: #4f97d7;">(</span>url, headers=headers<span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#21457;&#36865;&#35831;&#27714;</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.put<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://httpbin.org/put"</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.delete<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://httpbin.org/delete"</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.head<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://httpbin.org/get"</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.options<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://httpbin.org/get"</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

</section>
<section id="slide-orgheadline4">
<h3 id="orgheadline4">requests: HTTP for Humans 传递参数</h3>
<div class="org-src-container">

<pre  class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">payload</span> = <span style="color: #4f97d7;">{</span><span style="color: #2d9574;">'key1'</span>: <span style="color: #2d9574;">'value1'</span>, <span style="color: #2d9574;">'key2'</span>: <span style="color: #2d9574;">'value2'</span><span style="color: #4f97d7;">}</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.get<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">"http://httpbin.org/get"</span>, params=payload<span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #4f97d7; font-weight: bold;">print</span><span style="color: #4f97d7;">(</span>r.url<span style="color: #4f97d7;">)</span>
http://httpbin.org/get?<span style="color: #7590db;">key2</span>=value2&amp;<span style="color: #7590db;">key1</span>=value1
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35835;&#21462;&#21709;&#24212;&#20869;&#23481;</span>
&gt;&gt;&gt; <span style="color: #7590db;">r</span> = requests.get<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'https://github.com/timeline.json'</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; r.text
u<span style="color: #2d9574;">'[{"repository":{"open_issues":0,"url":"https://github.com/...</span>
</pre>
</div>



</section>
</section>
<section>
<section id="slide-orgheadline10">
<h2 id="orgheadline10">页面解析</h2>
<div class="outline-text-2" id="text-orgheadline10">
</div></section>
<section id="slide-orgheadline6">
<h3 id="orgheadline6">html - beautifulsoup</h3>
<div class="org-src-container">

<pre  class="src src-python">&gt;&gt;&gt; <span style="color: #7590db;">html</span> = urllib2.urlopen<span style="color: #4f97d7;">(</span>req, timeout=<span style="color: #a45bad;">20</span><span style="color: #4f97d7;">)</span>.read<span style="color: #4f97d7;">()</span>
&gt;&gt;&gt; <span style="color: #7590db;">content</span> = BeautifulSoup<span style="color: #4f97d7;">(</span>html, <span style="color: #2d9574;">"lxml"</span><span style="color: #4f97d7;">)</span>
&gt;&gt;&gt; <span style="color: #7590db;">title</span> = content.title.get_text<span style="color: #4f97d7;">()</span>
</pre>
</div>
</section>
<section id="slide-orgheadline7">
<h3 id="orgheadline7">html - pyquery</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #4f97d7; font-weight: bold;">from</span> pyquery <span style="color: #4f97d7; font-weight: bold;">import</span> PyQuery <span style="color: #4f97d7; font-weight: bold;">as</span> pq
<span style="color: #7590db;">content</span> = requests.get<span style="color: #4f97d7;">(</span>url, headers=headers<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">doc</span> = pq<span style="color: #4f97d7;">(</span>ret.text<span style="color: #4f97d7;">)</span>
<span style="color: #7590db;">en_mean_list</span> = doc<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'div.trans-container'</span><span style="color: #4f97d7;">)(</span><span style="color: #2d9574;">'ul'</span><span style="color: #4f97d7;">)(</span><span style="color: #2d9574;">'p.wordGroup'</span><span style="color: #4f97d7;">)</span>
</pre>
</div>
<p>
<img src="a.png" alt="a.png" />
<img src="b.png" alt="b.png" />
</p>

</section>
<section id="slide-orgheadline8">
<h3 id="orgheadline8">js - selenium</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #4f97d7; font-weight: bold;">from</span> selenium <span style="color: #4f97d7; font-weight: bold;">import</span> webdriver
<span style="color: #4f97d7; font-weight: bold;">from</span> selenium.common.exceptions <span style="color: #4f97d7; font-weight: bold;">import</span> NoSuchElementException
<span style="color: #4f97d7; font-weight: bold;">from</span> selenium.webdriver.common.keys <span style="color: #4f97d7; font-weight: bold;">import</span> Keys
<span style="color: #7590db;">base_url</span> = <span style="color: #2d9574;">'http://www.baidu.com/'</span>
<span style="color: #7590db;">browser</span> = webdriver.Chrome<span style="color: #4f97d7;">()</span>
browser.get<span style="color: #4f97d7;">(</span>base_url<span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#35835;&#21462;&#21709;&#24212;&#20869;&#23481;, &#36825;&#37324;&#20351;&#29992; pyquery &#36827;&#34892;&#35299;&#26512;</span>
<span style="color: #7590db;">doc</span> = pq<span style="color: #4f97d7;">(</span>browser.page_source<span style="color: #4f97d7;">)</span>
doc.xhtml_to_html<span style="color: #4f97d7;">()</span>
<span style="color: #2aa1ae; background-color: #292e34;"># </span><span style="color: #2aa1ae; background-color: #292e34;">&#28857;&#20987;&#20803;&#32032;</span>
browser.find_element_by_css_selector<span style="color: #4f97d7;">(</span><span style="color: #2d9574;">'.pagination .next'</span><span style="color: #4f97d7;">)</span>.click<span style="color: #4f97d7;">()</span>
</pre>
</div>

</section>
<section id="slide-orgheadline9">
<h3 id="orgheadline9">js - PhantomJS</h3>
<ul>
<li>HEADLESS WEBSITE TESTING</li>
<li>SCREEN CAPTURE</li>
<li>PAGE AUTOMATION</li>
<li>NETWORK MONITORING</li>
<li><a href="http://phantomjs.org/">http://phantomjs.org/</a></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline14">
<h2 id="orgheadline14">大规模爬虫</h2>
<div class="outline-text-2" id="text-orgheadline14">
</div></section>
<section id="slide-orgheadline11">
<h3 id="orgheadline11">防封锁</h3>
<ul>
<li>代理池</li>
<li>user agent 池</li>
<li>抓取频率</li>

</ul>
</section>
<section id="slide-orgheadline12">
<h3 id="orgheadline12">bloom filter</h3>
</section>
<section id="slide-orgheadline13">
<h3 id="orgheadline13">并发</h3>
<ul>
<li>多线程</li>
<li>多进程</li>
<li>协程</li>
<li>分布式</li>

</ul>


</section>
</section>
<section>
<section id="slide-orgheadline18">
<h2 id="orgheadline18">数据存储</h2>
<div class="outline-text-2" id="text-orgheadline18">
</div></section>
<section id="slide-orgheadline15">
<h3 id="orgheadline15">sqllite</h3>
</section>
<section id="slide-orgheadline16">
<h3 id="orgheadline16">mongodb</h3>
</section>
<section id="slide-orgheadline17">
<h3 id="orgheadline17">postgreSQL</h3>


</section>
</section>
<section>
<section id="slide-orgheadline21">
<h2 id="orgheadline21">框架</h2>
<div class="outline-text-2" id="text-orgheadline21">
</div></section>
<section id="slide-orgheadline19">
<h3 id="orgheadline19">scrapy</h3>
</section>
<section id="slide-orgheadline20">
<h3 id="orgheadline20">pyspider</h3>


</section>
</section>
<section>
<section id="slide-orgheadline22">
<h2 id="orgheadline22">Q &amp; A</h2>
</section>
</section>
</div>
</div>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/head.min.js"></script>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
